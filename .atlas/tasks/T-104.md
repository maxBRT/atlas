---
id: "T-104"
type: "task"
status: "done"
priority: "high"
parent_spec: "002-feature_specifications.md"
---

# Implement Backend API for Feature Specifications

This task implements the CRUD API endpoints for managing feature specification files in the `.atlas/specs/` directory.

## Sub-tasks:

- [x] **Define Zod Validation Schemas:**
    - Create schema for filename validation (must be `.md` file, valid characters).
    - Create schema for spec content (string/markdown content).

- [x] **Implement `GET /api/specs` Endpoint:**
    - Read all files from `.atlas/specs/` directory.
    - Return a JSON array of filenames.
    - Handle case where directory doesn't exist (return empty array or create it).

- [x] **Implement `GET /api/specs/{filename}` Endpoint:**
    - Validate the `filename` path parameter.
    - Read the content of `.atlas/specs/{filename}`.
    - Return the raw markdown content.
    - Return 404 if file doesn't exist.

- [x] **Implement `POST /api/specs` Endpoint:**
    - Validate the request body contains the filename and markdown content.
    - Write content to `.atlas/specs/{filename}`.
    - Create the file if it doesn't exist, overwrite if it does.
    - Return appropriate success response.

- [x] **Implement `DELETE /api/specs/{filename}` Endpoint:**
    - Validate the `filename` path parameter.
    - Delete the file from `.atlas/specs/`.
    - Return 404 if file doesn't exist.
    - Return success response on deletion.

- [x] **Add Security Validations:**
    - Prevent path traversal attacks (e.g., `../` in filename).
    - Ensure filename is sanitized before file operations.

- [x] **Write Unit Tests:**
    - Test listing specs returns correct array.
    - Test reading a spec returns its content.
    - Test creating a new spec file.
    - Test updating an existing spec file.
    - Test deleting a spec file.
    - Test error cases (404, invalid filename, path traversal).
