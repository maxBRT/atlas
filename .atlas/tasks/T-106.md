---
id: "T-106"
type: "task"
status: "todo"
priority: "medium"
parent_spec: "005-roadmap.md"
---

# Implement Backend API for Roadmap Management

This task implements the API endpoints for reading and updating the `roadmap.md` file, which stores the prioritized implementation order as a markdown ordered list.

## Sub-tasks:

- [ ] **Define Zod Validation Schemas:**
    - Create schema for roadmap items array (array of strings).
    - Validate that each item is a non-empty string.

- [ ] **Implement Roadmap Parsing Helper:**
    - Create a utility function to parse `.atlas/roadmap.md`.
    - Extract ordered list items from markdown content.
    - Handle various markdown list formats (numbered lists: `1.`, `2.`, etc.).
    - Return an array of strings (the text of each item).
    - Handle empty file or missing file gracefully.

- [ ] **Implement Roadmap Serialization Helper:**
    - Create a utility function to convert an array of strings back to markdown.
    - Generate properly formatted ordered list (`1. Item`, `2. Item`, etc.).
    - Preserve any header or preamble content if present.

- [ ] **Implement `GET /api/roadmap` Endpoint:**
    - Read `.atlas/roadmap.md` file.
    - Parse the markdown ordered list into an array.
    - Return JSON array of roadmap item strings.
    - Return empty array if file doesn't exist.

- [ ] **Implement `POST /api/roadmap` Endpoint:**
    - Validate request body is an array of strings.
    - Convert array to markdown ordered list format.
    - Write to `.atlas/roadmap.md`.
    - Create file if it doesn't exist.
    - Return success response.

- [ ] **Handle Edge Cases:**
    - Empty roadmap (no items).
    - Single item roadmap.
    - Items with special markdown characters.
    - Items with multi-line content (if supported).

- [ ] **Write Unit Tests:**
    - Test getting roadmap returns correct array.
    - Test posting new roadmap overwrites file correctly.
    - Test reordering items (post with different order).
    - Test adding new items.
    - Test removing items.
    - Test empty array handling.
    - Test file creation when roadmap.md doesn't exist.
    - Test parsing various markdown list formats.
