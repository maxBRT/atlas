# AI Context File Feature

## 1. Description

This feature is responsible for maintaining a `context.md` file in the `.atlas/` directory. This file is auto-generated and provides a snapshot of the project's structure, planning conventions, and other key information. Its primary purpose is to be a reference document for an AI agent, helping it understand how to interact with the project and the Atlas system.

This is a non-interactive feature. The file is generated by the backend and there is no direct UI for editing it.

## 2. Generation Trigger

The `context.md` file should be regenerated automatically whenever there is a significant change to the project structure or the planner files. This could be triggered by:
-   The server starting up.
-   A file being created/deleted/renamed in the `.atlas/` directory.
-   A manual "Refresh AI Context" button in the UI (optional).

## 3. Content of `context.md`

The generated file should contain:

-   A summary of the main application spec (`application.md`).
-   A list of all feature specifications (`.atlas/specs/*`).
-   A list of all open tasks (`.atlas/tasks/*` where status is not "done").
-   **Technical Stack:** A comprehensive overview of the project's technical stack. This will combine automatically detected information (from files like `package.json`, including languages, frameworks, dependencies, and scripts) with user-defined technical notes provided within `application.md` (specifically under a `## AI Technical Notes` heading).
-   A summary of the file/directory structure of the entire project repository. This helps the AI understand the codebase it's working with.
-   Instructions on how the AI should use the planner system (e.g., "To add a new task, create a file in `.atlas/tasks/` with the following format...").

## 4. Backend Logic

-   A dedicated internal function, e.g., `updateAiContext()`.
-   This function will:
    1.  Read `application.md`.
    2.  List files in `.atlas/specs/` and `.atlas/tasks/`.
    3.  **Detect & Combine Tech Stack:**
        a.  Scan for a `package.json` file. If found, parse it to extract dependencies, devDependencies, and scripts.
        b.  Read `application.md` and extract any content found under the `## AI Technical Notes` heading.
        c.  Combine the auto-detected information with the user-defined notes into a comprehensive "Technical Stack" summary.
    4.  Scan the project's directory structure (respecting `.gitignore`).
    5.  Assemble all this information into a single markdown string.
    6.  Write the string to `.atlas/context.md`.
-   The backend will call this function based on the triggers defined above. There is no public API endpoint for this, as it's a purely internal process.

## 5. File System

-   The single, auto-generated file will be located at `.atlas/context.md`.
-   This file is considered ephemeral and can be overwritten at any time. Users should not edit it manually.
